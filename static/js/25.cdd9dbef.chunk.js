"use strict";(self.webpackChunkfreepen=self.webpackChunkfreepen||[]).push([[25,189],{5189:function(e,r,t){t.r(r),t.d(r,{AppContext:function(){return h},default:function(){return x}});var n=t(4165),a=t(1413),s=t(5861),l=t(9439),i=t(2791),o=t(9460),c=t(2922),u=t(7799),d=t(4164),f=t(8820),p=t(3426),m=t(184);var g=function(e){var r=e.title,t=e.children,n=e.setModal,a=document.getElementById("portal");if(!a)return(0,m.jsx)(m.Fragment,{});var s=function(){n({isOpen:!1,title:"",children:(0,m.jsx)(m.Fragment,{})})};return(0,d.createPortal)((0,m.jsx)("div",{className:"portal fixed inset-0 flex items-center justify-center p-4 backdrop-blur-xl",style:{zIndex:5e3},onClick:s,children:(0,m.jsxs)("div",{className:"w-80 max-w-full overflow-hidden rounded bg-slate-100 ring-2 ring-slate-400/50 dark:bg-slate-800 dark:text-white",children:[(0,m.jsxs)("header",{className:"rounded-inherite flex items-center justify-between border-b border-dashed border-slate-400/50 bg-slate-50 p-4 dark:bg-slate-900",children:[(0,m.jsx)("h1",{className:"text-2xl font-bold",children:r}),(0,m.jsx)(f.oHP,{onClick:s,className:"cursor-pointer"})]}),(0,m.jsx)("section",{className:"overflow-auto p-4",children:t}),(0,m.jsx)("footer",{className:"rounded-inherite border-b border-slate-400/50 bg-slate-50 p-4 dark:bg-slate-900",children:(0,m.jsx)(p.Z,{onClick:s,variant:"primary",children:"OK"})})]})}),a)},h=(0,i.createContext)({userInfo:null,notifications:[],setNotifications:function(){return null},newError:function(e){return null},openModal:function(e,r){return null}});function b(e){var r=e.children,t=(0,i.useState)(null),d=(0,l.Z)(t,2),f=d[0],p=d[1],b=(0,i.useState)({isOpen:!1,title:"",children:(0,m.jsx)(m.Fragment,{})}),x=(0,l.Z)(b,2),v=x[0],w=x[1];i.useEffect((function(){console.log("Modal is ".concat(v.isOpen?"open":"closed"))}),[v.isOpen]),(0,o.Aj)(c.I,(0,s.Z)((0,n.Z)().mark((function e(){var r,t,s;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===c.I||void 0===c.I||null===(r=c.I.currentUser)||void 0===r||!r.uid){e.next=6;break}return t=(0,u.JU)(c.db,"users",c.I.currentUser.uid),e.next=4,(0,u.QT)(t);case 4:s=e.sent,p((function(){return(0,a.Z)({},s.data())}));case 6:case"end":return e.stop()}}),e)}))));var j=(0,i.useState)([]),y=(0,l.Z)(j,2),k=y[0],I=y[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(h.Provider,{value:{userInfo:f,notifications:k,setNotifications:I,newError:function(e){console.error(e)},openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Dialog",r=arguments.length>1?arguments[1]:void 0;w({isOpen:!0,title:e,children:r})}},children:r}),v.isOpen?(0,m.jsx)(g,{title:v.title,setModal:w,children:v.children}):null]})}var x=i.memo(b)},3426:function(e,r,t){var n=t(1413),a=t(2791),s=t(184);function l(e){return(0,s.jsxs)("button",(0,n.Z)((0,n.Z)({},e),{},{className:"flex cursor-pointer items-center justify-center gap-2 rounded py-2 px-4 ring-1 ring-slate-300 focus:ring-4 dark:ring-slate-700\n            ".concat("primary"===e.variant?"bg-primary-500 text-white hover:bg-primary-600":"bg-slate-50 text-slate-900 hover:bg-slate-100 dark:bg-slate-900 dark:text-white dark:hover:bg-slate-800","\n            ").concat(e.className),children:[e.icon&&e.icon,e.children]}))}r.Z=a.memo(l)},2922:function(e,r,t){t.d(r,{I:function(){return c},db:function(){return u},t:function(){return d}});var n=t(4702),a=t(9460),s=t(7799),l=t(276),i={apiKey:"AIzaSyBT-anIY9tZ7VQsqewvrLkjYBwSnRBUxOM",authDomain:"free-pen-blogs.firebaseapp.com",projectId:"free-pen-blogs",storageBucket:"free-pen-blogs.appspot.com",messagingSenderId:"395027834486",appId:"1:395027834486:web:ea9771bd119f5353372157",measurementId:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_KEY:"AIzaSyBT-anIY9tZ7VQsqewvrLkjYBwSnRBUxOM",REACT_APP_APP_ID:"1:395027834486:web:ea9771bd119f5353372157",REACT_APP_AUTH_DOMAIN:"free-pen-blogs.firebaseapp.com",REACT_APP_MESSAGING_SENDER_ID:"395027834486",REACT_APP_PROJECT_ID:"free-pen-blogs",REACT_APP_STORAGE_BUCKET:"free-pen-blogs.appspot.com"}.REACT_APP_MEASUREMENT_ID},o=(0,n.ZF)(i),c=(0,a.v0)(o),u=(0,s.ad)(o),d=(0,l.cF)(o)},3025:function(e,r,t){t.r(r),t.d(r,{default:function(){return I}});var n=t(4165),a=t(5861),s=t(9439),l=t(2791),i=t(3426),o=t(2922),c=t(8820),u=t(9460),d=t(7689),f=t(184);function p(e){var r=e.children,t=(0,l.useState)("loading"),n=(0,s.Z)(t,2),a=n[0],p=n[1];(0,d.s0)();return(0,u.Aj)(o.I,(function(e){p((function(){return Boolean(e)}))})),a?(0,f.jsx)(f.Fragment,{children:r}):"loading"===a?(0,f.jsx)("h1",{children:"Loading..."}):(i.Z,c.vM4,i.Z,c.SPH,(0,f.jsx)(f.Fragment,{}))}var m,g=l.memo(p),h=t(1413),b=t(5189),x=t(7692),v=t(276);function w(e){var r=e.id,t=e.setImageLink,c=(0,l.useState)({state:m.waitImage,progress:0,url:"",details:""}),u=(0,s.Z)(c,2),d=u[0],p=u[1],g=(0,l.useRef)(),w=(0,l.useContext)(b.AppContext).newError;function j(){return y.apply(this,arguments)}function y(){return(y=(0,a.Z)((0,n.Z)().mark((function e(){var t,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(0,v.iH)(o.t,"blogsThumbnails/".concat(r)),g.current.files){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,(0,v.B0)(a,null===g||void 0===g||null===(t=g.current)||void 0===t?void 0:t.files[0]);case 5:e.sent.task.on("state_changed",(function(e){var r=e.bytesTransferred/e.totalBytes*100;p((function(e){return(0,h.Z)((0,h.Z)({},e),{},{state:m.uploading,progress:r,url:"",details:""})}))}),(function(e){p((function(r){return(0,h.Z)((0,h.Z)({},r),{},{state:m.error,url:"",details:e.message})})),w(e||{message:"Error while uploading image"})}),(function(){(0,v.Jt)(a).then((function(e){p((function(r){return(0,h.Z)((0,h.Z)({},r),{},{state:m.gotURL,url:e,details:"Uploaded"})}))})).catch((function(e){w(e||{message:"Error while getting image url"}),p((function(r){return(0,h.Z)((0,h.Z)({},r),{},{state:m.error,url:"",details:e.message})}))}))}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,l.useEffect)((function(){t((function(){return d.url}))}),[d.url]),(0,f.jsx)(f.Fragment,{children:d.state===m.waitImage?(0,f.jsxs)(i.Z,{className:"relative w-full",children:[(0,f.jsxs)("span",{className:"pointer-events-none flex items-center gap-3",children:[(0,f.jsx)(x.Zw4,{className:"text-lg text-primary-500"})," Upload Thumbnail Image"]}),(0,f.jsx)("input",{type:"file",accept:"image/*",ref:g,className:"absolute inset-0 h-full w-full cursor-pointer opacity-0",onChange:j})]}):d.state===m.uploading?(0,f.jsxs)("div",{className:"bg-slage-400/50 relative flex h-12 items-center justify-center",children:[(0,f.jsx)("div",{className:"absolute left-0 h-full bg-primary-500",style:{width:"".concat(d.progress,"%")}}),(0,f.jsxs)("span",{children:["Uploading... ",d.progress,"%"]})]}):d.state===m.gotURL?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("img",{src:d.url,className:"object-fit aspect-video w-full rounded object-center ring-2 ring-primary-500",alt:"Thumbnail Image"}),(0,f.jsxs)(i.Z,{className:"relative w-full",children:[(0,f.jsxs)("span",{className:"pointer-events-none flex items-center gap-3",children:[(0,f.jsx)(x.Zw4,{className:"text-lg text-primary-500"})," Upload another Image"]}),(0,f.jsx)("input",{type:"file",accept:"image/*",ref:g,className:"absolute inset-0 h-full w-full cursor-pointer opacity-0",onChange:j})]})]}):d.state===m.error?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("span",{className:"font-bold",children:"Error:"}),d.details]}),(0,f.jsxs)(i.Z,{className:"relative w-full",children:[(0,f.jsxs)("span",{className:"pointer-events-none flex items-center gap-3",children:[(0,f.jsx)(x.Zw4,{className:"text-lg text-primary-500"})," Upload another Image"]}),(0,f.jsx)("input",{type:"file",accept:"image/*",ref:g,className:"absolute inset-0 h-full w-full cursor-pointer opacity-0",onChange:j})]})]}):(0,f.jsx)(f.Fragment,{})})}!function(e){e.waitImage="Upload thumbnail image",e.uploading="Uploading...",e.error="Error",e.gotURL="getUrl"}(m||(m={}));var j=(0,l.memo)(w),y=t(7799);function k(){var e=(0,l.useState)(""),r=(0,s.Z)(e,2),t=r[0],c=r[1],u=(0,l.useRef)(),p=(0,l.useRef)(),m=(0,d.s0)(),h=(0,l.useContext)(b.AppContext),x=h.newError,v=h.openModal,w="".concat(Math.random().toString(32).substring(2,12));l.useEffect((function(){v("New Blog",(0,f.jsx)("p",{children:"Create a new blog"}))}),[]);var k=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(r){var a,s,l;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),t){e.next=4;break}return v("Image is required",(0,f.jsx)("p",{className:"text-gray-500",children:"You must upload an image for your blog"})),e.abrupt("return");case 4:if(u.current.value&&p.current.value){e.next=7;break}return v("Title and text are required",(0,f.jsx)("p",{className:"text-gray-500",children:"You must write a title and the article body"})),e.abrupt("return");case 7:return s={id:w,title:u.current.value.toString(),body:p.current.value.toString(),image:t,authorId:null===(a=o.I.currentUser)||void 0===a?void 0:a.uid,blogInfo:{createdAt:y.EK.fromDate(new Date),readsCount:0,likesCount:0,sharesCount:0,commentsCount:0}},e.prev=8,l=(0,y.JU)(o.db,"blogs",w),e.next=12,(0,y.pl)(l,s);case 12:m("/blog/".concat(w)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),x(e.t0);case 18:case"end":return e.stop()}}),e,null,[[8,15]])})));return function(r){return e.apply(this,arguments)}}();return(0,f.jsx)(g,{children:(0,f.jsx)("main",{className:"flex min-h-full",children:(0,f.jsxs)("form",{className:"container flex min-h-full flex-auto flex-col space-y-2 py-4",onSubmit:k,children:[(0,f.jsx)("textarea",{required:!0,placeholder:"Title",ref:u,className:"min-h-40 h-[calc(1em+2rem)] max-h-[calc(2em+2rem)] w-full resize-none overflow-auto rounded border border-dashed border-slate-400/50 bg-transparent p-4 text-center text-5xl font-bold focus:ring-0 [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:rounded-full [&::-webkit-scrollbar-track]:bg-slate-400/50 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-primary-500",onInput:function(e){var r=e.currentTarget.scrollHeight;e.currentTarget.style.height="48px";var t=Math.floor(r/48);e.currentTarget.style.height="".concat(48*t+32,"px")}}),(0,f.jsx)(j,{id:w,setImageLink:c}),(0,f.jsx)("textarea",{required:!0,placeholder:"Write here",ref:p,className:"h-auto min-h-[40vh] w-full flex-auto resize-none rounded border border-dashed border-slate-400/50 bg-transparent p-4 text-xl focus:ring-0 [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-track]:rounded-full [&::-webkit-scrollbar-track]:bg-slate-400/50 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-primary-500",onInput:function(e){e.currentTarget.style.height="auto",e.currentTarget.style.height="".concat(e.currentTarget.scrollHeight,"px")}}),(0,f.jsx)(i.Z,{variant:"primary",className:"w-full",type:"submit",children:"Publish the blog"})]})})})}var I=(0,l.memo)(k)}}]);
//# sourceMappingURL=25.cdd9dbef.chunk.js.map